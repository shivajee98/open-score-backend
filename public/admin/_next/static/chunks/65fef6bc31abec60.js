(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,62398,e=>{"use strict";let t="https://api.msmeloan.sbs/api",s=async()=>{{let e=localStorage.getItem("token");if(e)return e}return null},a=async(e,a={})=>{let l=await s(),r={"Content-Type":"application/json",Accept:"application/json",...l&&{Authorization:`Bearer ${l}`},...a.headers},o=e.startsWith("/")?`${t}${e}`:`${t}/${e}`,n=await fetch(o,{...a,headers:r});if(!n.ok){401!==n.status||o.includes("/auth/")||(console.warn("[API] 401 Unauthorized - clearing token cache"),localStorage.removeItem("token"),localStorage.removeItem("user"));let e={};try{e=await n.json()}catch(e){console.error("[API] Failed to parse error response",e)}let t=e.error||e.message||`HTTP Error ${n.status}`;throw console.error(`[API Error] ${t}`,e),Error(t)}return n.json()};e.s(["apiFetch",0,a])},23522,e=>{"use strict";var t=e.i(84441),s=e.i(43844),a=e.i(1570),l=e.i(62398);function r(){let[e,r]=(0,s.useState)(""),[o,n]=(0,s.useState)(""),[i,c]=(0,s.useState)(1),[d,u]=(0,s.useState)("ADMIN"),[g,x]=(0,s.useState)(!1),[b,m]=(0,s.useState)(""),h=(0,a.useRouter)(),p=async()=>{x(!0),m("");try{await (0,l.apiFetch)("/auth/otp",{method:"POST",body:JSON.stringify({mobile_number:e})}),c(2)}catch(e){m(e.message)}finally{x(!1)}},f=async t=>{t.preventDefault(),x(!0),m("");try{console.log("[Agent Login] Attempting login with:",{mobile:e,role:"SUB_USER"});let t=await (0,l.apiFetch)("/auth/sub-user/login",{method:"POST",body:JSON.stringify({mobile_number:e,otp:o})});if(console.log("[Agent Login] Response:",t),t.access_token&&t.sub_user){let e={...t.sub_user,role:"SUB_USER",accessToken:t.access_token};localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("token",t.access_token),console.log("[Agent Login] Success! Redirecting to dashboard..."),h.push("/sub-user-dashboard/")}else m("Invalid Agent Credentials")}catch(e){console.error("[Agent Login] Exception:",e),m(e.message||"Login failed")}finally{x(!1)}},y=async()=>{x(!0),m("");try{let t=await (0,l.apiFetch)("/auth/verify",{method:"POST",body:JSON.stringify({mobile_number:e,otp:o,role:"ADMIN"})});if("ADMIN"!==t.user.role)throw Error("Access Denied: This number is not registered as an Administrator.");localStorage.setItem("user",JSON.stringify(t.user)),localStorage.setItem("token",t.token),setTimeout(()=>{h.push("/")},100)}catch(e){m(e.message||"Login Failed")}finally{x(!1)}};return(0,t.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-center bg-[#020617] p-6 text-white font-sans",children:(0,t.jsxs)("div",{className:"w-full max-w-md rounded-[2.5rem] bg-slate-900/50 p-8 border border-slate-800 shadow-2xl relative overflow-hidden",children:[(0,t.jsx)("div",{className:"flex justify-center mb-6",children:(0,t.jsxs)("div",{className:"flex p-1 bg-black/40 rounded-2xl border border-slate-800",children:[(0,t.jsx)("button",{onClick:()=>{u("ADMIN"),c(1)},className:`px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all ${"ADMIN"===d?"bg-sky-600 text-white shadow-lg shadow-sky-900/40":"text-slate-500 hover:text-slate-300"}`,children:"Master Admin"}),(0,t.jsx)("button",{onClick:()=>u("SUB_USER"),className:`px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all ${"SUB_USER"===d?"bg-indigo-600 text-white shadow-lg shadow-indigo-900/40":"text-slate-500 hover:text-slate-300"}`,children:"Agent Login"})]})}),(0,t.jsx)("h1",{className:"mb-2 text-4xl font-extrabold tracking-tight text-center bg-gradient-to-r from-sky-400 to-indigo-400 bg-clip-text text-transparent",children:"ADMIN"===d?"Admin Portal":"Agent Access"}),(0,t.jsx)("p",{className:"text-center text-slate-500 mb-8 text-sm font-bold uppercase tracking-widest",children:"ADMIN"===d?"System Control Center":"Network Management"}),b&&(0,t.jsx)("p",{className:"text-red-400 text-xs text-center mb-6 bg-red-400/10 py-3 rounded-xl border border-red-400/20 px-4",children:b}),"ADMIN"===d?1===i?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"group",children:[(0,t.jsx)("label",{className:"block text-xs font-semibold uppercase text-slate-500 mb-2 ml-1 group-focus-within:text-sky-400",children:"Mobile Number"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 font-bold text-sm",children:"+91"}),(0,t.jsx)("input",{type:"text",value:e,onChange:e=>{r(e.target.value.replace(/\D/g,"").slice(0,10))},className:"w-full rounded-2xl bg-black/20 border border-slate-800 pl-14 pr-5 py-4 text-white focus:outline-none focus:ring-2 focus:ring-sky-500/50 transition-all font-bold tracking-[0.2em] text-lg",placeholder:"00000 00000"})]})]}),(0,t.jsx)("button",{onClick:p,disabled:g||e.length<10,className:"w-full rounded-2xl bg-sky-600 py-4 font-black shadow-lg shadow-sky-900/40 hover:bg-sky-500 transition-all active:scale-[0.98] disabled:opacity-30 uppercase tracking-widest text-sm",children:g?"Sending Request...":"Get Access Code"})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"group text-center",children:[(0,t.jsx)("label",{className:"block text-xs font-semibold uppercase text-slate-500 mb-6",children:"Verification Code"}),(0,t.jsx)("input",{type:"text",autoFocus:!0,value:o,onChange:e=>{n(e.target.value.replace(/\D/g,"").slice(0,6))},className:"w-full rounded-2xl bg-black/20 border border-slate-800 p-5 text-white text-center text-3xl font-black tracking-[0.5em] focus:outline-none focus:ring-2 focus:ring-sky-500/50",placeholder:"000000"})]}),(0,t.jsx)("button",{onClick:y,disabled:g||o.length<6,className:"w-full rounded-2xl bg-emerald-600 py-4 font-black shadow-lg shadow-emerald-900/40 hover:bg-emerald-500 transition-all active:scale-[0.98] disabled:opacity-30 uppercase tracking-widest text-sm",children:g?"Verifying...":"Unlock System"}),(0,t.jsx)("button",{onClick:()=>{c(1),n("")},className:"w-full text-xs text-slate-500 hover:text-white transition-colors py-2 uppercase font-black",children:"← Return to Number Input"})]}):(0,t.jsxs)("form",{onSubmit:f,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"group",children:[(0,t.jsx)("label",{className:"block text-xs font-semibold uppercase text-slate-500 mb-2 ml-1 group-focus-within:text-indigo-400",children:"Agent Mobile Number"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 font-bold text-sm",children:"+91"}),(0,t.jsx)("input",{type:"tel",required:!0,value:e,onChange:e=>{r(e.target.value.replace(/\D/g,"").slice(0,10))},className:"w-full rounded-2xl bg-black/20 border border-slate-800 pl-14 pr-5 py-4 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all font-bold tracking-[0.2em] text-lg",placeholder:"00000 00000"})]})]}),(0,t.jsxs)("div",{className:"group",children:[(0,t.jsx)("label",{className:"block text-xs font-semibold uppercase text-slate-500 mb-2 ml-1 group-focus-within:text-indigo-400",children:"One-Time Password (OTP)"}),(0,t.jsx)("input",{type:"text",required:!0,maxLength:6,value:o,onChange:e=>{n(e.target.value.replace(/\D/g,"").slice(0,6))},className:"w-full rounded-2xl bg-black/20 border border-slate-800 px-5 py-4 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all font-bold text-center tracking-[0.3em] text-xl",placeholder:"••••••"})]})]}),(0,t.jsx)("button",{type:"submit",disabled:g||e.length<10||o.length<6,className:"w-full rounded-2xl bg-indigo-600 py-4 font-black shadow-lg shadow-indigo-900/40 hover:bg-indigo-500 transition-all active:scale-[0.98] disabled:opacity-30 uppercase tracking-widest text-sm",children:g?"Authenticating...":"Enter Dashboard"})]})]})})}e.s(["default",()=>r])}]);